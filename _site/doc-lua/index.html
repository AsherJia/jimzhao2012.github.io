<!DOCTYPE html>
<html>
<head>
    <!--
    * Author:         jimzhao
    -->
    <meta charset="utf-8" />
    <title>lua | jimzhao.com</title>
    <meta name="author" content="jimzhao" />
    <meta name="description" content="jimzhao's doc" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <link rel="stylesheet" href="/css/default.css" type="text/css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/atom.xml" />
    <script src="/js/jquery-1.7.1.min.js" type="text/javascript"></script>

      <!-- Bootstrap core CSS -->
    <link href="/css/bootstrap.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="/assets/js/html5shiv.js"></script>
      <script src="/assets/js/respond.min.js"></script>
    <![endif]-->
</head>
<script type="text/javascript">

String.prototype.endWith = function(oString){  
    var reg = new RegExp(oString+"$");  
    return reg.test(this);     
};

$(document).ready(function(){
    var href = window.location.href;
    $("a#doc").parent().attr("class","");
    $("li#test").attr("class","");

    if (href.endWith("index.html")) {
        $("a#home").parent().attr("class","active");
    }
    else if (href.endWith("/test-manual/")) {
        $("li#test").attr("class","active");
    } 
    else if (href.endWith("/doc-schema/")) {
        $("li#api").attr("class","active");
    }
    else {
       var isWHFDoc = false;
       if (href.endWith("/doc-description/")) {
            isWHFDoc = true;
        }
        else if (href.endWith("/doc-entry/")) {
            isWHFDoc = true;
        } 
        else if (href.endWith("/doc-learning/")) {
            isWHFDoc = true;
        } 
        else if (href.endWith("/doc-debug/")) {
            isWHFDoc = true;
        } 
        else if (href.endWith("/doc-faq/")) {
            isWHFDoc = true;
        }
        else if (href.endWith("/doc-api/")) {
            isWHFDoc = true;
        }
        if (isWHFDoc) {
            $("a#doc").parent().attr("class","active");
        }
    }
});

function dismissTabActive() {
     $("a#doc").parent().attr("class","");
     $("li#test").attr("class","");
     $("li#api").attr("class","");
};

$("a#atest").click(function(){
    $("a#atest").parent().attr("class","active");
});

$("a#urlschema").click(function(){
    $("a#urlschema").parent().attr("class","active");
});

$("a#api").click(function(){
    $("a#api").parent().attr("class","active");
});

</script>

<style type="text/css">
.navbar-default .navbar-nav > .active > a,
.navbar-default .navbar-nav > .active > a:hover,
.navbar-default .navbar-nav > .active > a:focus {
  color: blue;
  font-size: 16px;
/*  font-weight: bold;
*/  background-color: #e7e7e7;
}

.navbar-default .navbar-nav > li > a {
  color: #777777;
  font-size: 16px;
/*  font-weight: bold;
*/}

</style>
<body>

  <!-- Fixed navbar -->
    <div class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">Ctrip Hybrid Doc</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a class="ttaa"  id="doc" href="/doc-description/">开发文档</a></li>
            
            <li id="test" class="dropdown">
              <a onClick="dismissTabActive()" href="#" class="dropdown-toggle" data-toggle="dropdown">测试<b class="caret"></b></a>
              <ul class="dropdown-menu">
                  <li><a href="/test-manual/">手动测试</a></li>
                  <li><a target="_blank" href="/qunit/a.html">Qunit自动化测试</a></li>
              </ul>
            </li>

            <li id="api" class="dropdown">
              <a onClick="dismissTabActive()" href="#" class="dropdown-toggle" data-toggle="dropdown">Api文档<b class="caret"></b></a>
              <ul class="dropdown-menu">
                  <li><a href="/doc-schema/">URL Schema Doc</a></li>
                  <li><a href="/api/" target="_blank" >JS API Doc</a></li>    
              </ul>
            </li>

            <li class="dropdown">
              <a id="download" onClick="dismissTabActive()" href="#" class="dropdown-toggle" data-toggle="dropdown">源码下载<b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="/code/demo.zip">Demo下载</a></li>
                <li><a href="/code/bridge.js.zip">JSLib下载</a></li>
                <li><a href="/code/bridge.min.zip">JSLib 压缩版下载</a></li>
              </ul>
            </li>

            <li id="install" class="dropdown">
              <a onClick="dismissTabActive()" href="#" class="dropdown-toggle" data-toggle="dropdown">App安装<b class="caret"></b></a>
              <ul class="dropdown-menu">
<!--                   <li><a href="itms-services://?action=download-manifest&url=http://www.jimzhao.com/code/cw_dev_install.plist">iOS App安装</a></li>
 -->                  <li><a href="http://www.jimzhao.com/code/cw_dev.ipa">iOS ipa下载</a></li>
                  <li><a onClick="alert('Android App安装将在稍后支持。');" target="_blank" >Android App安装</a></li>    
              </ul>
            </li>

          </ul>
        </div>
      </div>
    </div>

   <!--  <div class="home-menu">
        <div class="home-icon-con">
            <a class="home-menu-icon" href="/">BeiYuu</a>
            <a class="home-follow" href="#" title="Contact Me">+</a>
        </div>
        <div class="home-contact">
            <a href="http://weibo.com/beiyuu/" target="_blank" style="margin-left:-5px;"><img src="http://www.weibo.com/favicon.ico" alt="" width="25"/></a>
            <a href="http://www.douban.com/people/beiyuu/" target="_blank" style="text-align:center;"><img src="http://www.douban.com/favicon.ico" alt="" width="22"/></a>
            <a href="http://instagram.com/beiyuu/" target="_blank" style="text-align:right"><img src="http://d36xtkk24g8jdx.cloudfront.net/bluebar/00c6602/images/ico/favicon.ico" alt="" width="22"/></a>
        </div>
    </div> -->


    <link rel="stylesheet" href="/js/prettify/prettify.css" />
<style type="text/css">
    body { background:#e8e8e8; }
    @media screen and (max-width: 750px){
        body { background:#fff; }
    }
    @media screen and (max-width: 1020px){
        body { background:#fff; }
    }
</style>

<div id="content">
    <div class="entry">
        <h1 class="entry-title"><a href="/doc-lua" title="lua">lua</a></h1>
        <p class="entry-date">2014-01-13</p>


        <h3 id="toc_0">1. lua 简介</h3>
<div class="highlight"><pre><code class="text language-text" data-lang="text">Lua是一种脚本编程语言,于1994年,由巴西里约热内卢天主教大学的研究人员设计开发, “Lua”这个名字是葡萄牙语单词 “月亮”。

• 与一般脚本语言如PHP、Perl、JavaScript等不同,Lua被称为是一种嵌入式脚本语言;
• Lua最引人注目的特点:
  – 以极小的体积和简单的语法提供相对全面的功能。 
  – 以简洁的API实现与宿主语言最方便的接口。
  - 体积小:200~300K
  - 最快的脚本语言(非 JIT) 
  - 动态语言
</code></pre></div>
<h3 id="toc_1">2 lua 的嵌入式</h3>
<div class="highlight"><pre><code class="text language-text" data-lang="text">• Lua语言可以独立进行编程,但这不是其主要的使用方式。Lua虽然有动态、灵活的语法提供强大的功能,但并不像 Java、Python 等一样有一个完善的库(但仍存在一定数量的第三方库), 这不是缺陷,而是和其定位有关。
• Lua最典型的用法,是作为一个库,嵌入到其他大型语言(称之为宿主语言)的应用程序之中,为应用程序提供参数配置或逻辑描述等功能。
• Lua常见的宿主语言有:C/C++,Java,.NET, 甚至脚本语言如PHP,Ruby等。
</code></pre></div>
<h3 id="toc_2">3. lua和动态语言OC/Java</h3>
<div class="highlight"><pre><code class="text language-text" data-lang="text">• 宿主语言为Objective-C/Java(JIT桥接);
• 宿主语言中编译进去lua解释器;
• 将实现的Lua扩展,如函数等, 注册到Lua解释器中,这样lua代码中可以使用这些扩展函数。
• 读入Lua源程序或预先编译后的Lua程序;
• 执行读入的Lua程序;
</code></pre></div>
<h3 id="toc_3">4. wax 介绍</h3>
<div class="highlight"><pre><code class="text language-text" data-lang="text">Wax是一个框架，让你可以用Lua开发原生的iPhone应用。Wax把Lua和Objetive-C的类库桥接起来，也就是说，你可以用Lua使用任何的Objective-C类及框架。

为什么使用Wax?
• Wax是免费的、开源的。你总是可以改动源代码，以满足自己的需要;
• 用Lua这种高效脚本语言编写代码可以大大节省时间;
• 可以使用所有现有的Objective-C库;
• 可以让你的App在线更新一些功能，不再需要经过苹果App Store的审核;
• 可以通过lua脚本，动态替换一些Objective-C函数;
</code></pre></div>
<h3 id="toc_4">5. 使用场景&amp;能做什么－－扩展</h3>
<div class="highlight"><pre><code class="text language-text" data-lang="text">• 线上版本新增功能，wax支持IterfaceBuilder，方面开发UI界面；
• 在线bug fix，替换有bug的函数；
• (由于其调试比较麻烦，不能debug，只能log，因此正常版本迭代不建议使用)；
</code></pre></div>
<h3 id="toc_5">7. wax还需要研究&amp;改进的点－－问题</h3>
<div class="highlight"><pre><code class="text language-text" data-lang="text">• 1.对C方法的不支持，可能需要对wax框架改进，注册一些常用c方法到lua，已经测试ok，需要整体设计处理;
• 2.对block没有支持，要想办法解决，正在测试中;
• 3.对OC类新增成员变量，相对容易;
• 4.lua脚本编译&amp;加密；
• 5.lua解析器的引入对app整体性能的影响；
• 6.wax框架的稳定性测试；
• 7.跨平台，lua脚本也可以编译到android工程中，让java做为其宿主语言，这样也就可以在android中实现类似wax功能；
</code></pre></div>
<h3 id="toc_6">8. 风险</h3>
<div class="highlight"><pre><code class="text language-text" data-lang="text">wax for iPhone框架已经不再维护了
</code></pre></div>

     <!--    <div id="disqus_container">
            <a href="#" class="comment" onclick="return false;">点击查看评论</a>
            <div id="disqus_thread"></div>
        </div> -->
    </div>

   <!--  <div class="sidenav">
        <iframe width="100%" height="75" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=75&fansRow=2&ptype=1&speed=0&skin=5&isTitle=0&noborder=0&isWeibo=0&isFans=0&uid=1855270953&verifier=375b89d6&dpc=1"></iframe>
    </div> -->
<!-- 
    <div class="sidenav">
        <h2>Blog</h2>
        <ul class="artical-list">
        
            <li><a href="/jekyll-install">安装jekyll</a></li>
        
        </ul>

        <h2>Opinion</h2>
        <ul class="artical-list">
        
        </ul>

        <h2>Project</h2>
        <ul class="artical-list">
        
        </ul>
    </div>
</div> -->

<script src="/js/post.js" type="text/javascript"></script>


    <!--*********************************************************-->
    <!--****** 宝贝儿，看见这个时候，删掉下面的统计代码哦~ ******-->
    <!--************* 再推荐下我的第一篇博客哦~~ ****************-->
    <!--*********************************************************-->

    <script src="/js/bootstrap.min.js"></script>
  <!--   <div class="hide">
        <script type="text/javascript" src="http://js.tongji.linezing.com/2727758/tongji.js"></script>
        <noscript><a href="http://www.linezing.com"><img src="http://img.tongji.linezing.com/2727758/tongji.gif"/></a></noscript>
    </div> -->

</body>
</html>
